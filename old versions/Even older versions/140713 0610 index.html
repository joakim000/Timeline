<!DOCTYPE html><html><head><title>Timeline of composers</title><link rel="icon" type="image/ico" href="favicon_timeline.ico"><script src="http://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script><link rel="stylesheet" href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.11.0/themes/smoothness/jquery-ui.css" /><script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.11.0/jquery-ui.min.js"></script><link rel="stylesheet" href="http://malihu.github.io/custom-scrollbar/jquery.mCustomScrollbar.min.css" /><script src="http://malihu.github.io/custom-scrollbar/jquery.mCustomScrollbar.concat.min.js"></script><script src="xinspect.js"></script><script>function resizeIframe(obj) {    console.log(obj.contentWindow.document.body.scrollHeight);	obj.style.height = obj.contentWindow.document.body.scrollHeight + 'px';  }</script><style type='text/css'>     body { background-color:DDD; margin: none; }     iframe { position:relative; top:40px; left:0px; right:0px; bottom:0px;			  display:block; margin:0 auto; overflow:hidden;}</style></head><body id='tlbody' ><form>	<fieldset style="width:600px; height:60px; float:left;"><legend>Slice of history</legend>		<div class="ui-widget" style="width:300px; height:60px; float:left; text-align:center;">			<label id='labellow' for='controllow'>Beginning of time</label>			<input style="width:280px;" type='range' id='controllow' name='low' 				   min='1000' max='2000' value='' step='20' onInput='displayYear(labellow, controllow, controlhigh)' />			</div>		<div class="ui-widget" style="width:300px; height:60px; float:left; text-align:center;">			<label id='labelhigh' for='controlhigh'>End of time</label>			<input style="width:280px;" type='range' id='controlhigh' name='high'				   min='1020' max='2020' value='' step='20' onInput='displayYear(labelhigh, controlhigh, controllow)' />		</div>	</fieldset></form><form>	<fieldset style="width:30px; height:60px; float:left; position:relative;"><legend>Zoom</legend>		<div class="ui-widget" style="width:30px; height:60px; float:left; position:absolute; top:50%; margin-top:-7px">			<select id='zoom' name='zoom'					onInput='doOver(controllow.value, controlhigh.value, composers, zoom.options[zoom.selectedIndex].value)'>				<option id='zoom1' value=1>1</option><option id='zoom2' value=2>2</option>				<option id='zoom3' value=3>3</option><option id='zoom4' value=4>4</option>				<option id='zoom5' value=5>5</option>			</select>		</div>	</fieldset></form><form>	<fieldset style="width:275px; height:60px; float:left; position:relative;"><legend>Add a composer</legend>		<div class="ui-widget" style="width:275px; height:60px; float:left; position:absolute; top:50%; margin-top:-7px">			<input id='inputcomposer' name='inputcomposer' style="width:200px;" />			<input type="button" id="addButton" value="Add" onClick="addComposerReload()" />		</div>	</fieldset></form><br /><br /><br /><br /><br /><div class="ui-widget" id='container' ></div><iframe src="info.html" width="1010" height="420" frameborder="0" id='infoframe' name='infoframe' seamless='seamless'		 scrolling="no" onload="resizeIframe(this)"></iframe><br />		<script>function addComposerReload(){	function getExtract(pipeSeparatedListComposers) {		return $.getJSON(URL, {			action:"query",			prop:"extracts",			exintro:"",			titles:pipeSeparatedListComposers,		})	}		newCompLink = inputcomposer.value.replace(/ /g, '_');	if (composers.indexOf(newCompLink) == -1) {		getExtract(newCompLink).done(function(data) {			//console.log(xinspect(data));			if (data.query) {				pages = data.query.pages;					pageid = Object.getOwnPropertyNames(pages);				extract = pages[pageid].extract;				if(extract) {					composers.push(newCompLink);					//console.log(composers);					doOver(controllow.value, controlhigh.value, composers, zoom.options[zoom.selectedIndex].value)				}				else { alert('No wikipedia page found for: ' + inputcomposer.value);									}			}			// Fallthrough if data.query is undefined / false (submitted with empty string)		});	}	else { alert('Already on timeline: ' + inputcomposer.value); }}function displayYear(label, con, otherCon){	if (label.id == 'labellow'){		if (con.value >= (otherCon.value)) { con.value = otherCon.value - 20;}	}	if (label.id == 'labelhigh'){		if (con.value <= (otherCon.value)) { con.value = otherCon.value;} // +20 leads to bug where con.value gets set to max	}	label.innerHTML=con.value;	doOver(controllow.value, controlhigh.value, composers, zoom.options[zoom.selectedIndex].value)}function timeAxis(low, high, expandFactor){	function period(name, start, end, color){		this.name = name;		this.start = start;		this.end = end;		this.color = color;	}		var periods =  [new period('Medieval', 1200, 1400, 'orange'), new period('Renaissance', 1400, 1600, 'yellow'),					new period('Baroque', 1600, 1745,'brown'), new period('Classical', 1745, 1820, 'gray'),					new period('Romantic', 1820, 1900, 'red'),	new period('Modern', 1900, 1930, 'pink'),					new period('Contemporary', 1975, new Date().getFullYear(), 'khaki')];			tlWidth = (high-low)*expandFactor;	var tl = document.createElementNS(svgNS, 'svg');	tl.setAttributeNS(null, 'height', '72');	tl.setAttributeNS(null, 'width', (tlWidth+margin*2).toString());	document.getElementById('container').style = 'width:' + (tlWidth+30) + 'px;';		for (i in periods){			var pp = document.createElementNS(svgNS, 'rect');// pp: Paint Period			var translatePx = ((periods[i].start - low) * expandFactor + margin);			var w = (periods[i].end - periods[i].start) * expandFactor;			pp.setAttributeNS(null, 'height', '17');			pp.setAttributeNS(null, 'style', 'fill:'+periods[i].color+';stroke:black;stroke-width:0;opacity:1.0');			pp.setAttributeNS(null, 'id', 'period' + [i]);			pp.setAttributeNS(null, 'x', translatePx + margin); 			pp.setAttributeNS(null, 'y', '28');			pp.setAttributeNS(null, 'width', w);		tl.appendChild(pp);			var ppT = document.createElementNS(svgNS, 'text');			ppT.setAttributeNS(null, 'class', 'legend');			ppT.setAttributeNS(null, 'font-size', '16'); 			ppT.setAttributeNS(null, 'fill', 'black');			ppT.setAttributeNS(null, 'y', '42');			if (periods[i].start < low){				ppT.setAttributeNS(null, 'x', margin + 10);				ppT.innerHTML = '<< ' + periods[i].name;			}			else {				ppT.setAttributeNS(null, 'x', translatePx + 10);				ppT.innerHTML = periods[i].name;			}		tl.appendChild(ppT);	}		var line = document.createElementNS(svgNS, 'line');		line.setAttributeNS(null, 'id', 'line');		line.setAttributeNS(null, 'x1', margin);		line.setAttributeNS(null, 'y1', '25');		line.setAttributeNS(null, 'x2', tlWidth + margin);		line.setAttributeNS(null, 'y2', '25');		line.setAttributeNS(null, 'style', 'stroke:black;stroke-width:5');	tl.appendChild(line);		var beL = document.createElementNS(svgNS, 'line');		beL.setAttributeNS(null, 'id', 'bookendL');		beL.setAttributeNS(null, 'x1', margin);		beL.setAttributeNS(null, 'y1', '5');		beL.setAttributeNS(null, 'x2', margin);		beL.setAttributeNS(null, 'y2', '45');		beL.setAttributeNS(null, 'style', 'stroke:black;stroke-width:5');	tl.appendChild(beL);		var beR = document.createElementNS(svgNS, 'line');		beR.setAttributeNS(null, 'id', 'bookendR');		beR.setAttributeNS(null, 'x1', tlWidth + margin);		beR.setAttributeNS(null, 'y1', '5');		beR.setAttributeNS(null, 'x2', tlWidth + margin);		beR.setAttributeNS(null, 'y2', '45');		beR.setAttributeNS(null, 'style', 'stroke:black;stroke-width:5');	tl.appendChild(beR);		var yearL = document.createElementNS(svgNS, 'text');		yearL.setAttributeNS(null, 'class', 'legend');		yearL.setAttributeNS(null, 'font-size', '16'); 		yearL.setAttributeNS(null, 'fill', 'black');		yearL.setAttributeNS(null, 'x', margin + 4);		yearL.setAttributeNS(null, 'y', '20');		yearL.innerHTML = low.toString();	tl.appendChild(yearL);		var yearR = document.createElementNS(svgNS, 'text');		yearR.setAttributeNS(null, 'class', 'legend');		yearR.setAttributeNS(null, 'font-size', '16');		yearR.setAttributeNS(null, 'fill', 'black');		yearR.setAttributeNS(null, 'x', tlWidth + margin - 45);		yearR.setAttributeNS(null, 'y', '20');		yearR.innerHTML = high.toString();	tl.appendChild(yearR);			container.appendChild(tl);	container.appendChild(document.createElement('br'));}function buildTimeline(composers, low, high, expandFactor){	function getExtract(pipeSeparatedListComposers) {		return $.getJSON(URL, {			action:"query",			prop:"extracts",			exintro:"",			titles:pipeSeparatedListComposers,		})	}	/*	// Build list of composers to get data for	var cList = ""	for (c in composers) {		cList = cList + composers[c] + "|"	}	cList = cList.slice(0,-1);	test1.innerHTML = cList;	*/	var j = 0;	for (i in composers) {		getExtract(composers[i]).done(function(cData) {			pages = cData.query.pages;			pageid = Object.getOwnPropertyNames(pages);			title = pages[pageid].title;			extract = pages[pageid].extract;						var yearPattern = /\d\d\d\d/;			var pos = extract.search(yearPattern);			var born = extract.substring(pos, pos+4);			var stringTemp = extract.substring(pos+4);			pos = stringTemp.search(yearPattern);			var died = stringTemp.substring(pos, pos+4); 						var bornI = parseInt(born); var diedI = parseInt(died); 									var translatePx = ((bornI - low)*expandFactor + margin);			var tlWidth = (high-low)*expandFactor;						var box = document.createElementNS(svgNS, 'svg');			box.setAttributeNS(null, 'id', 'box' + j);			box.setAttributeNS(null, 'class', 'box');			box.setAttributeNS(null, 'height', '53');			box.setAttributeNS(null, 'width', tlWidth); 								var linkedRect = document.createElementNS(svgNS, 'a');				//composerlink = decodeURIComponent(title.replace(/ /g, '_'));				composerlink = title.replace(/ /g, '_');				linkedRect.setAttributeNS(xlinkNS, 'xlink:href', 'info.html?composer='+composerlink);				linkedRect.setAttributeNS(null, 'target', 'infoframe'); 									var shape = document.createElementNS(svgNS, 'rect');					shape.setAttributeNS(null, 'rx', '25');					shape.setAttributeNS(null, 'ry', '25');					shape.setAttributeNS(null, 'height', '50');					shape.setAttributeNS(null, 'style', 'fill:lightblue;stroke:black;stroke-width:0;opacity:1.0');					shape.setAttributeNS(null, 'id', 'shape' + j);					shape.setAttributeNS(null, 'x', translatePx); 					shape.setAttributeNS(null, 'y', '1');					var w = (died - born) * expandFactor;					shape.setAttributeNS(null, 'width', w);					//shape.onClick('alert("Alert!")');					//$('rect#shape'+j).on('click', function(){					//	alert('alert! alert!');					//});				linkedRect.appendChild(shape);									var name = document.createElementNS(svgNS, 'text');					name.setAttributeNS(null, 'id', 'name' + j);					name.setAttributeNS(null, 'class', 'name');					name.setAttributeNS(null, 'font-size','17');					name.setAttributeNS(null, 'fill', 'black');					name.setAttributeNS(null, 'x', translatePx+13);					name.setAttributeNS(null, 'y', '23');					name.innerHTML = title;					// Handle names that don't fit					var nameTooLong = false;					if (title == 'Wolfgang Amadeus Mozart' || title =='Felix Mendelssohn' || title=='Pyotr Ilyich Tchaikovsky') { nameTooLong = true; } // Testing					if (nameTooLong){						splitTitle = title.split(' ');						lastName = splitTitle[splitTitle.length-1];						initialsLastName = '';						for (n in splitTitle){							initialsLastName = initialsLastName + splitTitle[n][0];						}  						initialsLastName = initialsLastName.substr(0,initialsLastName.length-1);						initialsLastName = initialsLastName + ' ' + lastName;						name.innerHTML = lastName;						name.innerHTML = initialsLastName;					}				linkedRect.appendChild(name);									var years = document.createElementNS(svgNS, 'text');					years.setAttributeNS(null, 'id', 'years' + j);					years.setAttributeNS(null, 'class', 'years');					years.setAttributeNS(null, 'font-size', '13');					years.setAttributeNS(null, 'fill', 'black');					years.setAttributeNS(null, 'x', translatePx+15);					years.setAttributeNS(null, 'y', '42');					years.innerHTML = born + ' - ' + died;				linkedRect.appendChild(years);						box.appendChild(linkedRect);			container.appendChild(box);			container.appendChild(document.createElement('br'));			cc.push(new composer(title.replace(/ /g, '_'), title, bornI, diedI, extract));			j++;					});	}}		function composer(link, name, born, died, extract){	this.link = link;	this.name = name;	this.born = born;	this.died = died;	//this.wasA = wasA;	this.extract = extract;}function buildAddList() {		function getCompList() {		return $.getJSON(URL, {			action:"parse",			prop:"links",			page:"List_of_composers_by_name",		})	}	getCompList().done(function(data) {		linkObjArray = data.parse.links;		var links = [];		for (i in linkObjArray) {			var obj = linkObjArray[i];			links.push(obj["*"]);		}		$(function() {			$( "#inputcomposer" ).autocomplete({				source: links			});		});	});	}function doOver(low, high, composers, expandFactor){	$('#container').empty();	build(low, high, composers, expandFactor)	}function build(low, high, composers, expandFactor){	//Build the axis	timeAxis(low,high, expandFactor);		//Add composers	buildTimeline(composers, low, high, expandFactor);		// Set startvalues for sliders and options	labellow.innerHTML = low; controllow.value = low; labelhigh.innerHTML = high; controlhigh.value = high;	currentZoom = document.getElementById('zoom' + expandFactor); currentZoom.selected='selected';	buildAddList();}var infohtml = 'info.html';var svgNS = "http://www.w3.org/2000/svg";  var xlinkNS = "http://www.w3.org/1999/xlink";var URL = "http://en.wikipedia.org/w/api.php?format=json&callback=?"var margin = 3;var composers=["Franz_Liszt", "Johann_Sebastian_Bach", "Felix_Mendelssohn", "Wolfgang_Amadeus_Mozart",			"Pyotr_Ilyich_Tchaikovsky", "Frédéric_Chopin", "Joseph_Haydn", 	"Ludwig_van_Beethoven", 			"Edvard_Grieg", "Alexander_Borodin"];//var composersAdd = composers;var composers=["Johann_Sebastian_Bach", "Wolfgang_Amadeus_Mozart", "Frédéric_Chopin", "Edvard_Grieg"];//var composers=["Johann_Sebastian_Bach"];var cc = []	//composer cache//build(1650, 1920, composers, 4);build(1520, 2014, composers, 5);</script></body></html>